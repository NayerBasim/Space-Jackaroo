package engine;
import engine.board.*;
import model.Colour;
import model.player.*;
import model.card.*;

import java.util.Random;
import java.io.*; // to throw IOException if the constructor runs into an error
import java.util.ArrayList; // to use arrayList

public class Game implements GameManager {
	final Board board ; // read only ,  An Object representing the game board
	final ArrayList<Player> players ; // read only , representing the players participating in the game.
	final private  ArrayList<Card> firePit; //read only, An arraylist representing the cards that have been played
	private int currentPlayerIndex ; // An integer representing which of the players should play next
	private int turn ; // An integer representing the current game turn.
	
	public Game(String playerName) throws IOException{
		
		//filling the "ArrayList<Colour> colourOrder" at random-----
		ArrayList<Colour> colourOrder = new ArrayList<>();
		ArrayList<Integer> coloursUsed = new ArrayList<>();
		for(int i =0; i<4;){
			int randomNum = (int) (Math.random() * 4); // 0 to 3
			if(!(coloursUsed.contains(randomNum))){
				
				switch(randomNum){
					case 0:
						colourOrder.add(Colour.RED);
						break;
					case 1:
						colourOrder.add(Colour.GREEN);
						break;
					case 2:
						colourOrder.add(Colour.BLUE);
						break;
					case 3: 
						colourOrder.add(Colour.YELLOW);
						break;
				}
				i++;
			}
		}
		//----------------------------------------------------------
		this.board = new Board(colourOrder,this); // (check the typeCase)
		
		Deck.loadCardPool(this.board,this); //(check the typeCase)
		
		this.players = new ArrayList<>();
		//this adds a player with the name in the constructor and the first colour in the colourOrder arraylist
		Player player_1 =new Player(playerName,colourOrder.get(0));
		CPU cpu_1 =new CPU("CPU 1",colourOrder.get(1),this.board);
		CPU cpu_2 =new CPU("CPU 2",colourOrder.get(2),this.board);
		CPU cpu_3 =new CPU("CPU 3",colourOrder.get(3),this.board);
		
		players.add(player_1);
		players.add(cpu_1);
		players.add(cpu_2);
		players.add(cpu_3);
		// set a hand for each player---------------
		for(int i=0; i<4;i++){
			players.get(i).setHand( Deck.drawCards());
		}
		//-------------------------------------------
		this.currentPlayerIndex=0;
		this.turn=0;
		this.firePit = new ArrayList<>();
	}
	public Board getBoard(){
		return this.board;
	}
	public ArrayList<Player> getPlayers(){
		return this.players;
	}
	public int getCurrentPlayerIndex(){
		return currentPlayerIndex;
	}
	public void setCurrentPlayerIndex(int currentPlayerIndex){
		this.currentPlayerIndex = currentPlayerIndex;
	}
	public int getTurn(){
		return this.turn;
	}
	public void setTurn(int turn){
		this.turn =turn;
	}
}
