package model.card;

import java.util.List;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Scanner;

import com.opencsv.CSVReader;
import com.opencsv.exceptions.CsvException;

import model.card.standard.*;
import model.card.wild.*;
import engine.GameManager;
import engine.board.BoardManager;

public class Deck {
	private final static String CARDS_FILE = "Cards.csv";
	private static ArrayList<Card> cardsPool;
	
	public Deck(){
		cardsPool = new ArrayList<Card>();
		
	}
	public static boolean isValidEnum(String value) {
	    for (Suit s : Suit.values()) {
	        if (s.name().equals(value)) {
	            return true;
	        }
	    }
	    return false;
	}
	public static void handleString(String[]  arr, BoardManager boardManager, GameManager gameManager){
		int code  = Integer.parseInt(arr[0]);
		int frequency = Integer.parseInt(arr[1]);
		String name = arr[2];
		String description = arr[3];
		if(arr.length == 6 && arr[4].length() > 0 && isValidEnum(arr[5])){


			int rank = Integer.parseInt(arr[4]);

			
			Suit suit =  Suit.valueOf(arr[5]);
			
			switch(code){
			case 0:
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new Standard(name, description, rank, suit, boardManager, gameManager));
				}
				break;
			case 1 :
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new Ace(name, description, suit, boardManager, gameManager));
				}
				break;
			case 4 :
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new Four(name, description, suit, boardManager, gameManager));
				}
				break;
			case 5 :
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new Five(name, description, suit, boardManager, gameManager));
				}
				break;
			case 7 :
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new Seven(name, description, suit, boardManager, gameManager));
				}
				break;
			case 10 :
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new Ten(name, description, suit, boardManager, gameManager));
				}
				break;
			case 11 :
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new Jack(name, description, suit, boardManager, gameManager));
				}
				break;
			case 12 :
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new Queen(name, description, suit, boardManager, gameManager));
				}
				break;
			case 13 :
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new King(name, description, suit, boardManager, gameManager));
				}
				break;
			default:
				System.out.println("Not a valid id number in cards" + code);
				
			}
		}else if(arr.length == 6 && arr[4].length() == 0 && arr[5].length() == 0){

			switch(code){
			
			case 14 :
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new Saver(name, description, boardManager, gameManager));
				}
				break;
			case 15 :
				for(int i = 0 ; i < frequency; i++){
					cardsPool.add(0,new Burner(name, description, boardManager, gameManager));
				}
				break;
			default:
				System.out.println("Not a valid id number in wild " + code);
				
			}
				
		}else{
			System.out.println(arr[0] + " " + arr[1] + " "  +arr[2] + " " +arr[3] + " " +arr[4]+ " "  +arr[5]);
			System.out.println(arr[4].length() == 1 );
		}
			
	}

	public static void loadCardPool(BoardManager boardManager, GameManager gameManager) throws IOException, CsvException{

        try (CSVReader reader = new CSVReader(new FileReader(CARDS_FILE))) {
            List<String[]> rows = reader.readAll();
            for (String[] row : rows) {
            	handleString(row, boardManager, gameManager);
                System.out.println();
            }
        }
         catch (IOException e) {
            e.printStackTrace();
        }
	}
	public static ArrayList<Card> drawCards(){
		Collections.shuffle(cardsPool);
		ArrayList<Card> out = new ArrayList<Card>();
		for(int i = 0 ; i < 4 ; i++){
			out.add(cardsPool.remove(0));
		}
		return out;
		
		
	}
	
	
}
